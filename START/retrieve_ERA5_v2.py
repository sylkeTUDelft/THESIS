# -*- coding: utf-8 -*-
"""
Created on Wed May 31 10:00:16 2023

@author: sylke
"""
#add coordinates in latitude/longitude/latitude/longitude
 
#add coordinates in latitude/longitude/latitude/longitude

import cdsapi
import xarray as xr
import cfgrib

coords = {
    '1_1_era5': [54.67, -3.53],
    '2_1_era5': [54.20, -3.33],
    '3_1_era5': [51.91, -4.58],
    '4_1_era5': [51.65, -3.45],
    '5_1_era5': [50.14, -5.20],
    '6_1_era5': [53.41, -4.42],
    '7_1_era5': [50.65, -4.31],
    '8_1_era5': [50.48, -4.86],
    '9_1_era5': [50.91, -4.49],
    '10_1_era5': [52.41, -3.88],
    '11_1_era5': [51.94, -4.94],
    '12_1_era5': [51.96, -5.03],
    '13_1_era5': [58.60, -3.60],
    '14_1_era5': [50.33, -5.03],
    '15_1_era5': [50.35, -5.03],
    '16_1_era5': [52.46, -3.42],
    '17_1_era5': [52.3, 4.8],
    '18_1_era5': [51.2, 3.9],
    '19_1_era5': [52.1, 6.7],
    '20_1_era5': [52.0, 4.9],
    '21_1_era5': [51.9, 4.3],
    '22_1_era5': [53.5, 5.9],
    '23_1_era5': [51.71, 3.03],
    '24_1_era5': [52.41, 4.15],
    '25_1_era5': [53.98, -3.67],
    '26_1_era5': [53.87, -3.20],
    '27_1_era5': [53.48, -3.51],
    '28_1_era5': [54.01, 5.33],
    '29_1_era5': [51.98, 2.02],
    '30_1_era5': [51.75, 1.26],
    '31_1_era5': [51.75, 1.26],
    '32_1_era5': [53.48, -3.51],
    '33_1_era5': [53.87, -3.20],
    '34_1_era5': [51.93, 3.67],
    '35_1_era5': [53.16, 3.37],
    '36_1_era5': [53.8, 2.9],
    '37_1_era5': [51.71, 3.03],
    '38_1_era5': [51.71, 3.03],
    '39_1_era5': [52.34, 3.43],
    '40_1_era5': [52.41, 4.15],
    '41_1_era5': [54.01, 5.33],
    '42_1_era5': [55.10, 2.70]
}

years = {
    '1_1_era5': ['1991', '1992'],
    '2_1_era5': ['1991', '1992'],
    '3_1_era5': ['1991', '1992'],
    '4_1_era5': ['1991', '1992'],
    '5_1_era5': ['1991', '1992'],
    '6_1_era5': ['1991', '1992'],
    '7_1_era5': ['1991', '1992', '1993'],
    '8_1_era5': ['1991', '1992'],
    '9_1_era5': ['1991', '1992'],
    '10_1_era5': ['1991', '1992'],
    '11_1_era5': ['1991', '1992'],
    '12_1_era5': ['1991', '1992'],
    '13_1_era5': ['1991', '1992'],
    '14_1_era5': ['1991', '1992'],
    '15_1_era5': ['1991', '1992'],
    '16_1_era5': ['1991', '1992'],
    '17_1_era5': ['2012', '2013', '2014'],
    '18_1_era5': ['2012', '2013', '2014'],
    '19_1_era5': ['2012', '2013', '2014'],
    '20_1_era5': ['2012', '2013', '2014'],
    '21_1_era5': ['2012', '2013', '2014'],
    '22_1_era5': ['2012', '2013', '2014'],
    '23_1_era5': ['2016', '2017'],
    '24_1_era5': ['2017', '2018', '2019'],
    '25_1_era5': ['2005', '2006', '2007', '2008'],
    '26_1_era5': ['2004', '2005', '2006', '2007'],
    '27_1_era5': ['2005', '2006', '2007', '2008'],
    '28_1_era5': ['2019', '2020'],
    '29_1_era5': ['2005', '2006', '2007'],
    '30_1_era5': ['2005', '2006', '2007'],
    '31_1_era5': ['2005','2006', '2007'],
    '32_1_era5': ['2005', '2006', '2007', '2008'],
    '33_1_era5': ['2004', '2005', '2006', '2007'],
    '34_1_era5': ['2012', '2013', '2014'],
    '35_1_era5': ['2012', '2013', '2014'],
    '36_1_era5': ['2012', '2013', '2014', '2015'],
    '37_1_era5': ['2016', '2017'],
    '38_1_era5': ['2016', '2017'],
    '39_1_era5': ['2020', '2021'],
    '40_1_era5': ['2017', '2018', '2019'],
    '41_1_era5': ['2019', '2020'],
    '42_1_era5': ['2013', '2014']
}


delta = 0.13
coords = {station: [lat, lon - 2*delta, lat - 2*delta, lon] for station, [lat, lon] in coords.items()}

c = cdsapi.Client()

for station in coords: 
    station_coord = coords[station]
    station_years = years[station]
    data = c.retrieve(
        'reanalysis-era5-single-levels',
        {
            'product_type': 'reanalysis',
            'variable': [
                '10m_u_component_of_wind', '10m_v_component_of_wind',
            ],
            'year': station_years,
            'month': [
                '01', '02', '03',
                '04', '05', '06',
                '07', '08', '09',
                '10', '11', '12',
            ],
            'day': [
                '01', '02', '03',
                '04', '05', '06',
                '07', '08', '09',
                '10', '11', '12',
                '13', '14', '15',
                '16', '17', '18',
                '19', '20', '21',
                '22', '23', '24',
                '25', '26', '27',
                '28', '29', '30',
                '31',
            ],
            'time': [
                '00:00', '01:00', '02:00',
                '03:00', '04:00', '05:00',
                '06:00', '07:00', '08:00',
                '09:00', '10:00', '11:00',
                '12:00', '13:00', '14:00',
                '15:00', '16:00', '17:00',
                '18:00', '19:00', '20:00',
                '21:00', '22:00', '23:00',
            ],
            'area': 
                station_coord
            ,
            'format': 'grib',
        },
        f'C:/path/to/folder/ERA5/gribfiles/{station}.grib'
    )


